<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PartyLine</title>
    <link rel="stylesheet" href="/css/partyline.css">

</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <img src="/images/partyline_logo_horizontal-03.png">
        </div>
        
		<%- include('partials/partyMenu') %>

        <div class="join">
            <a href="/party">Join A New Party</a>
        </div>
    </div>
    <div class="content">
        <div class="topbar">
            <div class="userprofile">
                <a href="#">User 1 Profile</a>
                <a href="#">Settings</a>
                <a href="#">Help</a>
            </div>
            <div class="search">
				<%- include('partials/searchBar') %>
            </div>
        </div>
        <div class="main">
            <div class="sidemenu">
                <h2><%= partyName %></h2>
                <p><%= partyDescription %></p>
				<%
				let amSubscribed = false;
				for ( let i = 0; i < partyMenu.length; i++ ) {
					if ( partyMenu[i].id == partyId ) {
						amSubscribed = true;
					}
				}
				
				if ( ! amSubscribed ) { 
				%> 
				<form method="post" action="/subscribe/<%= partyId %>"><input type="submit" value="Join Party"></form>
				<% } %>
                <ul>
                    <li>#Braves</li>
                    <li>#World Series</li>
                </ul>
                <form action="/party/:party_id" method="post" class="subParty">
					<label for="subParty"><b>Create New Sub Party</b></label>
					<input type="text" placeholder="Enter Party Name" name="subParty" required>
                    <label for="subParty">Description</label>
                    <input type="text" placeholder="Describe Party" name="description">
                    <input type="submit" value="Submit">
                </form>
            </div>
            <div class="chat">
                <div class="messages">
                    <% for ( let i = 0; i < messages.length; i++ ) { %>
                    <div class="message"> 
                        <div class="username">User <%= messages[i].user_id %></div>
                        <div class="timestamp"><%= messages[i].sent_on %></div>
                        <div class="messageText"><%= messages[i].message %></div>
                    </div>
					<% } %>
                </div>
                <div class="chatform">
                    <div class="newMessage">
                        <form method="post" action="/party/<%= partyId %>">
                            <label for="newMessage"></label>
                            <input type="text" id="newMessage" name="newMessage" placeholder="Message Goes Here...">
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>